C51 COMPILER V9.52.0.0   MENU                                                              06/02/2018 13:38:54 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE MENU
OBJECT MODULE PLACED IN Menu.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE Menu.c LARGE OPTIMIZE(6,SPEED) BROWSE INCDIR(G:\CB589P) DEBUG OBJECTEXTEND 
                    -TABS(2)

line level    source

   1          #include "system.h"
   2          #include "Menu.h"
   3          #include "MenuEvent.h"
   4          #include "key.h"
   5          
   6          
   7          
   8          /***************************************修改记录*****************************************************
   9            Function List：
  10              1、MenuOperate       菜单操作程序   
  11           Change Log:
  12          
  13          ****************************************************************************************************/
  14          
  15          
  16          /*-------------------------------------------------------------------------
  17          *函数：Channel_Menu  信道菜单
  18          *参数：无
  19          *返回值：无
  20          *-------------------------------------------------------------------------*/
  21          void Channel_Menu(unsigned char key)
  22          {
  23   1        switch (key)
  24   1        {
  25   2        case KEY_SQ:
  26   2          playButtonTone();
  27   2          mMenu.keyCombSQUP = 1;
  28   2          mKey.isKeyCombo = 1;    
  29   2          break;
  30   2        case KEY_LONG_SQ:
  31   2          playButtonTone();
  32   2          CHANNEL_LONG_SQ_FUC();
  33   2          break;
  34   2        case KEY_UP:
  35   2          playButtonTone();
  36   2          if (mMenu.keyCombSQUP == 1)
  37   2          {
  38   3            CHANNEL_SWITCH_TUTTONTONE_FUC();
  39   3            mMenu.keyCombSQUP = 0;
  40   3            mMenu.keyCombSQDN = 0;
  41   3            mKey.isKeyCombo = 0;
  42   3          }
  43   2          else  CHANNEL_UP_FUC();
  44   2      
  45   2          break;
  46   2        case KEY_LONG_UP:
  47   2          playButtonTone();
  48   2          mSqParam.ScanDir = 1;
  49   2          mMenu.MenuIndex = CHANNEL_SCAN;
  50   2          CHANNEL_SCAN_FUC();
  51   2          break;
  52   2        case KEY_DN:
  53   2          playButtonTone();
  54   2          CHANNEL_DN_FUC();
C51 COMPILER V9.52.0.0   MENU                                                              06/02/2018 13:38:54 PAGE 2   

  55   2          break;
  56   2        case KEY_LONG_DN:
  57   2          playButtonTone();
  58   2          mSqParam.ScanDir = 1;
  59   2          mMenu.MenuIndex = CHANNEL_SCAN;
  60   2          CHANNEL_SCAN_FUC();
  61   2          break;
  62   2        case KEY_VOX:
  63   2          playButtonTone();
  64   2          CHANNEL_VOX_FUC();
  65   2          break;
  66   2        case KEY_LONG_VOX:
  67   2          playButtonTone();
  68   2          mMenu.MenuIndex = CHANNEL_LOCK;
  69   2          CHANNEL_LOCK_FUC();
  70   2          break;
  71   2        case KEY_PTY:
  72   2          playButtonTone();
  73   2          CHANNEL_PTY_FUC();
  74   2          break;
  75   2        case KEY_AFM:
  76   2          playButtonTone();
  77   2          CHANNEL_AFM_FUC();
  78   2          break;
  79   2        case KEY_LONG_AFM:
  80   2          playButtonTone();   
  81   2          CHANNEL_LONG_AF_FUC();
  82   2          break;
  83   2        case KEY_PPT_DN:
  84   2          playButtonTone();
  85   2          CHANNEL_PPT_DN_FUC();
  86   2          break;
  87   2        case KEY_PPT_UP:
  88   2          playButtonTone();
  89   2          CHANNEL_PPT_UP_FUC();
  90   2          break;
  91   2        default:
  92   2          break;
  93   2        }
  94   1      }
  95          
  96          /*-------------------------------------------------------------------------
  97          *函数：Scan_Menu  扫描菜单
  98          *参数：无
  99          *返回值：无
 100          *-------------------------------------------------------------------------*/
 101          void Scan_Menu(unsigned char key)
 102          {
 103   1        switch (key)
 104   1        {
 105   2        case KEY_LONG_UP:
 106   2          playButtonTone();
 107   2          mMenu.MenuIndex = CHANNEL;
 108   2          CHANNEL_SCAN_LONG_PRESS_FUC();
 109   2          break;
 110   2        case KEY_UP:
 111   2          playButtonTone();
 112   2          mMenu.MenuIndex = CHANNEL;
 113   2          CHANNEL_SCAN_LONG_PRESS_FUC();
 114   2          break;
 115   2        case KEY_DN:
 116   2          playButtonTone();
C51 COMPILER V9.52.0.0   MENU                                                              06/02/2018 13:38:54 PAGE 3   

 117   2          mMenu.MenuIndex = CHANNEL;
 118   2          CHANNEL_SCAN_LONG_PRESS_FUC();
 119   2          break;
 120   2        case KEY_LONG_DN:
 121   2          playButtonTone();
 122   2          mMenu.MenuIndex = CHANNEL;
 123   2          CHANNEL_SCAN_LONG_PRESS_FUC();
 124   2          break;
 125   2        case KEY_PPT_DN:
 126   2          playButtonTone();
 127   2          CHANNEL_SCAN_PPT_DN_FUC();
 128   2          break;
 129   2        case KEY_PPT_UP:
 130   2          playButtonTone();
 131   2          CHANNEL_SCAN_PPT_UP_FUC();
 132   2          break;
 133   2        default:
 134   2          break;
 135   2        }
 136   1      }
 137          
 138          /*-------------------------------------------------------------------------
 139          *函数：Country_Menu  国家菜单
 140          *参数：无
 141          *返回值：无
 142          *-------------------------------------------------------------------------*/
 143          void Country_Menu(unsigned char key)
 144          {
 145   1        switch (key)
 146   1        {
 147   2        case KEY_UP:
 148   2          playButtonTone();
 149   2          CHANNEL_COUNTRY_UP_FUC();
 150   2          break;
 151   2        case KEY_DN:
 152   2          playButtonTone();
 153   2          CHANNEL_COUNTRY_DN_FUC();
 154   2          break;
 155   2        case KEY_PPT_DN:
 156   2          playButtonTone();
 157   2          mMenu.MenuIndex = CHANNEL;
 158   2          CHANNEL_REST_FUC();
 159   2          break;
 160   2        default:
 161   2          break;
 162   2        }
 163   1      }
 164          /*-------------------------------------------------------------------------
 165          *函数：Lock_Menu  锁键状态菜单
 166          *参数：无
 167          *返回值：无
 168          *-------------------------------------------------------------------------*/
 169          void Lock_Menu(unsigned char key)
 170          {
 171   1        switch (key)
 172   1        {
 173   2        case KEY_SQ:
 174   2          playButtonTone();
 175   2          CHANNEL_LOCK_OTHERKEY_FUC();
 176   2          break;
 177   2        case KEY_LONG_SQ:
 178   2          playButtonTone();
C51 COMPILER V9.52.0.0   MENU                                                              06/02/2018 13:38:54 PAGE 4   

 179   2          CHANNEL_LOCK_OTHERKEY_FUC();
 180   2          break;
 181   2        case KEY_UP:
 182   2          playButtonTone();
 183   2          CHANNEL_LOCK_OTHERKEY_FUC();
 184   2          break;
 185   2        case KEY_LONG_UP:
 186   2          playButtonTone();
 187   2          CHANNEL_LOCK_OTHERKEY_FUC();
 188   2          break;
 189   2        case KEY_DN:
 190   2          playButtonTone();
 191   2          CHANNEL_LOCK_OTHERKEY_FUC();
 192   2          break;
 193   2        case KEY_LONG_DN:
 194   2          playButtonTone();
 195   2          CHANNEL_LOCK_OTHERKEY_FUC();
 196   2          break;
 197   2        case KEY_VOX:
 198   2          playButtonTone();
 199   2          CHANNEL_LOCK_OTHERKEY_FUC();
 200   2          break;
 201   2        case KEY_PTY:
 202   2          playButtonTone();
 203   2          CHANNEL_LOCK_OTHERKEY_FUC();
 204   2          break;
 205   2        case KEY_AFM:
 206   2          playButtonTone();
 207   2          CHANNEL_LOCK_OTHERKEY_FUC();
 208   2          break;
 209   2        case KEY_LONG_VOX:
 210   2          playButtonTone();
 211   2          mMenu.MenuIndex = CHANNEL;
 212   2          CHANNEL_DELOCK_FUC();
 213   2          break;
 214   2        case KEY_PPT_DN:
 215   2          playButtonTone();
 216   2          CHANNEL_PPT_DN_FUC();
 217   2          break;
 218   2        case KEY_PPT_UP:
 219   2          playButtonTone();
 220   2          CHANNEL_PPT_UP_FUC();
 221   2          break;
 222   2        default:
 223   2          break;
 224   2        }
 225   1      }
 226          /*-------------------------------------------------------------------------
 227          *函数：BackLight_Menu  背景颜色菜单
 228          *参数：无
 229          *返回值：无
 230          *-------------------------------------------------------------------------*/
 231          void BackLight_Menu(unsigned char key)
 232          {
 233   1        switch (key)
 234   1        {   
 235   2          case KEY_UP:
 236   2            playButtonTone();
 237   2            CHANNEL_BACKCOLOR_UP_FUC();
 238   2            break;    
 239   2          case KEY_DN:
 240   2            playButtonTone();
C51 COMPILER V9.52.0.0   MENU                                                              06/02/2018 13:38:54 PAGE 5   

 241   2            CHANNEL_BACKCOLOR_DN_FUC();
 242   2          break;    
 243   2          case KEY_PPT_DN:
 244   2            playButtonTone();
 245   2            mMenu.MenuIndex = CHANNEL;
 246   2            CHANNEL_REST_FUC();
 247   2            while(PPT==0);
 248   2            break;
 249   2          default:
 250   2            break;
 251   2        }
 252   1      }
 253          /*-------------------------------------------------------------------------
 254          *函数：PowerSet_Menu  发射功率菜单
 255          *参数：无
 256          *返回值：无
 257          *-------------------------------------------------------------------------*/
 258          void PowerSet_Menu(unsigned char key)
 259          {
 260   1        switch (key)
 261   1        {   
 262   2          case KEY_UP:
 263   2            playButtonTone();
 264   2            CHANNEL_TXPOWER_CHANGE_FUC();
 265   2            break;    
 266   2          case KEY_DN:
 267   2            playButtonTone();
 268   2            CHANNEL_TXPOWER_CHANGE_FUC();
 269   2          break;    
 270   2          case KEY_PPT_DN:
 271   2            playButtonTone();
 272   2            mMenu.MenuIndex = CHANNEL;
 273   2            CHANNEL_REST_FUC();
 274   2            while(PPT==0);
 275   2            break;
 276   2          default:
 277   2            break;
 278   2        }
 279   1      }
 280          
 281          void Check_ComKey_Flag(unsigned char key)
 282          {
 283   1        if (mMenu.keyCombSQUP == 1 && key != KEY_UP) { mMenu.keyCombSQUP = 0; mKey.isKeyCombo = 0; }   //非组合键
             -清状态值
 284   1        if (mMenu.keyCombSQDN == 1 && key != KEY_DN) { mMenu.keyCombSQDN = 0; mKey.isKeyCombo = 0; }
 285   1      }
 286          
 287          
 288          /*-------------------------------------------------------------------------
 289          *函数：MenuOperate  菜单按键
 290          *参数：无
 291          *返回值：无
 292          *-------------------------------------------------------------------------*/
 293          void MenuOperate(unsigned char key)
 294          {
 295   1        Check_ComKey_Flag(key);
 296   1        
 297   1        switch(mMenu.MenuIndex)
 298   1        {
 299   2          case CHANNEL:                                 //通道菜单
 300   2            Channel_Menu(key);
 301   2            break;    
C51 COMPILER V9.52.0.0   MENU                                                              06/02/2018 13:38:54 PAGE 6   

 302   2          case CHANNEL_SCAN:                               //扫描模式界面
 303   2            Scan_Menu(key);
 304   2            break;
 305   2          case CHANNEL_COUNTRY:                             //国家界面
 306   2            Country_Menu(key);
 307   2            break;
 308   2          case CHANNEL_LOCK:                                //  锁屏界面
 309   2            Lock_Menu(key);
 310   2            break;
 311   2          case CHANNEL_BACKLIGHT:                           //背景灯界面
 312   2            BackLight_Menu(key);
 313   2            break;
 314   2          case CHENNEL_POWER:                               //发射功率界面
 315   2            PowerSet_Menu(key);
 316   2            break;    
 317   2          default:
 318   2            break;
 319   2        }
 320   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    700    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----       1
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
